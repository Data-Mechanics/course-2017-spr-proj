# Boston Public School Transportation Challenge - School Bus Routing System Optimizations
Team: [Lingyi Gu](https://github.com/lingyigu), [Wei Wei](https://github.com/wei0496), [Haoyu(Jerry) Wu](https://github.com/wuhaoyujerry)

## Objective
The [Boston Public Schools](http://www.bostonpublicschools.org/) has announced a [Transportation Challenge](http://bostonpublicschools.org/transportationchallenge).  Our group is really interested in this challenge and starts this project. It contributes to Step 2 of the Routing Challenge, which aims to improve the school bus routing efficiency.  Specifically, we want to optimize the route for each school bus to get all students  to school as quickly as possible. We use the data set  of students who attend Boston Public Schools and optimize the bus routes based on their locations. Detailed methods are listed as follow.

In 2016, transportation costs accounted for for $110 million. Among them, Boston Public School’s transportation cost is the #2 highest. Our team utilizes the data mechanics techniques to solve this challenge. Our main objectives include:
* Address the inefficiencies and rising costs in current transportation system
* Improve the school bus routing efficiency to decrease students riding time § Reduce operational cost by systemically allocating resources


## Data Retrieval, Storage, Provenance, and Transformations


## Modeling, Optimization, and Statistical Analysis
### Overall Assumption
Consider the project deadline and our capability, we made a few assumptions for the sake of simplicity:
1. We assume that students are picked up from their home location.
2. We ignore the bell time.
3. We also assume that each bus has unlimited capacity.

### Assigning Students to Buses
We retrieve the students’ coordinates and schools they attend from the data set and aggregate by school names.
#### Number of buses
We set each school bus to have 50 seats, which is same as a normal bus size.  Therefore, we have a general idea of how many buses we need for each school.
#### K-means Clustering Algorithm
In order to make sure each bus has shortest route, it needs to pick students that live near to each other. Therefore, we implement the [k-mean clustering](https://en.wikipedia.org/wiki/K-means_clustering)  algorithm to group the students based on their location. Then we find the student points in each cluster and store them into the new data set ```assigned_students```. Because we cannot control how many students are assigned into each cluster, we cannot  guarantee that each bus have less than 50 students.

### Bus Route
We use the new data obtained from the previous algorithm.
#### Minimum Spanning Tree
We implement the [Minimum Spanning Tree](https://en.wikipedia.org/wiki/Minimum_spanning_tree) algorithm to find the relatively minimum distance for each bus to pick all the students in that cluster. The algorithm outputs a pickup sequence for each school bus. For each mean point found in the previous algorithm, we store the pickup sequence with the student's ID (generated by MongoDB) and pick up location into the data set ```bus_route```.
We have not assigned a bus yard to each mean point yet, but it can be done by finding the closest bus yard to each mean.
###### Special Cases:
Some students live very close to each other so they have the same coordination in the dataset. Therefore, the Minimum Spanning Tree will return 0 as the total distance.
###### Issue:
Although MST returns the minimum weight of the tree, the issue regarding it is that
the bus would go "there and back" for every subtree. This may lead to redundant traveling route. Another approach to find the efficient routing is to rank each student
based on their distance from the starting point, represented by {S1, S2, S3, S4,..., Sn} and run Dijkstra algorithm
to between each point to find the shortest route. However, we did not implement this algorithm in this Project because we are not sure which approach would be more efficient.
This is a potential algorithm we may implement in the final project to compare with the MST algorithm and decide which algorithm is more efficient.
## Running Time
It takes approximately 15 minutes to the entire project.
#### Trial Mode
```
$ python execute.py echogu_wei0496_wuhaoyu --trial
```
###### AssignStudents
In the trial mode, we select students from ```k``` schools randomly. You can set the number of schools by changing the value of ```k``` in the following line.
```python
school_students = random.choices(school_students, k = 1)
```
Since the school to be run in the trial mode is chosen randomly, sometimes it takes more than a few seconds to run if a school has a large population.
###### OptimizeBusRoutes
If the input data set is small enough, we pass the trial; otherwise, we select ```k``` points from the data sets generated by previous algorithm randomly. Similarly, you can set the number of points by changing the value of  ```k``` in the following line:
```python
assigned_students = random.choice(assigned_students, k = 10)
```


## Visualizations and Web Services


## Installation
Follows the procedure in [Data-Mechanics/course-2017-spr-proj](https://github.com/Data-Mechanics/course-2017-spr-proj).

###### Required libraries
```
$ pip install prov --upgrade --no-cache-dir
$ pip install dml --upgrade --no-cache-dir
$ pip install protoql --upgrade --no-cache-dir
$ pip install geopy
```
###### Run
```
$ python execute.py echogu_wei0496_wuhaoyu
```


## Reference
